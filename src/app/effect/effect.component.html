<mat-card style="padding-top: 1em;">
  <mat-card-header style="margin-bottom: 2em; justify-content: space-between;">
    <mat-icon (click)="openDialog()" style="position: relative;
    top: 0.5em;
    right: 0.5em;">add</mat-icon>

      <mat-form-field class="full-width">
        <mat-icon *ngIf="query != ''" matPrefix (click)="resetSearch()">clear</mat-icon>
        <input (keydown)="queryChanged($event)" type="text" matInput placeholder="Search" [(ngModel)]="query">
        <mat-icon matSuffix (click)="doSearch()">search</mat-icon>
      </mat-form-field>
      
    
    
      

  </mat-card-header>

  <mat-card-content>
    <mat-accordion>
      <mat-expansion-panel *ngFor="let effect of effects" [expanded]="expandedEffect === effect._id" (opened)="expandEffect(effect._id)" (closed)="expandEffect(null)">
        <mat-expansion-panel-header>
          <mat-panel-title>
            
                        <mat-icon (click)="openCauseDialog(effect, $event)" style="margin-right:1em;cursor: pointer;">add</mat-icon>

                        <mat-icon (click)="deleteEffect(effect, $event)" style="margin-right:1em;cursor: pointer;">delete_sweep</mat-icon>
            

            <mat-icon color="primary" style="margin-right:1em;" *ngIf="effect.sentiment == 1">sentiment_very_satisfied</mat-icon>
            <mat-icon color="accent" style="margin-right:1em;" *ngIf="effect.sentiment == 0">sentiment_neutral</mat-icon>
            <mat-icon color="warn" style="margin-right:1em;" *ngIf="effect.sentiment == -1">sentiment_very_dissatisfied</mat-icon>
            {{ effect.name }}
          </mat-panel-title>
          <mat-panel-description>
            {{ effect.created_at | date: 'dd/MM/yyyy - hh:mm'}}

          </mat-panel-description>
        </mat-expansion-panel-header>



        <mat-list>
          <h3 mat-subheader *ngIf="effect.children.length > 0">Contributing Causes</h3>
          <mat-list-item *ngFor="let cause of effect.children">
            <mat-icon mat-list-icon style="margin-right:1em;cursor: pointer;">add</mat-icon>
            <mat-icon mat-list-icon style="margin-right:1em;cursor: pointer;">visibility</mat-icon>
            <mat-icon mat-list-icon style="margin-right:1em;">delete_sweep</mat-icon>
            <mat-icon mat-list-icon style="margin-right:1em;" *ngIf="cause.sentiment == 1">sentiment_very_satisfied</mat-icon>
            <mat-icon mat-list-icon style="margin-right:1em;" *ngIf="cause.sentiment == 0">sentiment_neutral</mat-icon>
            <mat-icon mat-list-icon style="margin-right:1em;" *ngIf="cause.sentiment == -1">sentiment_very_dissatisfied</mat-icon>
            
            <h4 mat-line>{{ cause.name }}</h4>
            <p mat-line class="demo-2">{{ cause.created_at | date: 'dd/MM/yyyy - hh:mm'}}</p>
            <h4 mat-subheader mat-line *ngIf="cause.children.length > 0">Caused Actions</h4>
            <ul mat-line>
              <li *ngFor="let action of cause.children">
                <mat-icon mat-list-icon style="margin-right:1em;cursor: pointer;">visibility</mat-icon>
                <mat-icon mat-list-icon style="margin-right:1em;cursor: pointer;">delete</mat-icon>
                <mat-icon color="primary" style="margin-right:0.25em;" *ngIf="action.sentiment == 1">sentiment_very_satisfied</mat-icon>
                <mat-icon color="accent" style="margin-right:0.25em;" *ngIf="action.sentiment == 0">sentiment_neutral</mat-icon>
                <mat-icon color="warn" style="margin-right:0.25em;" *ngIf="action.sentiment == -1">sentiment_very_dissatisfied</mat-icon>
                {{action.name}} ({{ action.created_at | date: 'dd/MM/yyyy - hh:mm'}})</li>
            </ul>




          </mat-list-item>


        </mat-list>

      </mat-expansion-panel>





    </mat-accordion>

  </mat-card-content>

</mat-card>
